<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>

	<head>
		<meta http-equiv="content-type" content="text/html;charset=windows-1251">
		<meta name="Description" content="K&R, 1st ed., 1978. Russian translation by <unknown>; chm-compiling by Sim&C, Belarus`2006">
   		<title>5.2 Указатели и аргументы функций</title>
		<link href="../style.css" rel="stylesheet" type="text/css" media="all">
	</head>

	<body>
	<script  language=JavaScript  src="../header.js"></script>
	<pre>    Так как в C передача аргументов функциям осуществляет-
ся "по значению", вызванная процедура не имеет непосредст-
венной возможности изменить переменную из вызывающей прог-
раммы. Что же делать, если вам действительно надо изменить
аргумент? Например, программа сортировки захотела бы поме-
нять два нарушающих порядок элемента с помощью функции с
именем swap. Для этого недостаточно написать

 swap(a, b);

определив функцию swap при этом следующим образом:

 swap(x, y)      /* wrong */
 int x, y;
 {
    int temp;
    temp = x;
    x = y;
    y = temp;
 }

из-за  вызова  по  значению  swap не может воздействовать на
агументы a и b в вызывающей функции.
    К счастью, все же имеется возможность получить  желаемый
эффект.  Вызывающая  программа передает указатели подлежащих
изменению значений:

swap(&amp;a, &amp;b);

так как операция &amp; выдает адрес переменной, то  &amp;a  является
указателем на a. В самой SWAP аргументы описываются как ука-
затели и доступ к фактическим операндам осуществляется через
них.

swap(px, py)    /* interchange *px and *py */
int *px, *py;
{
   int temp;
   temp = *px;
   *px = *py;
   *py = temp;
}

    Указатели в качестве аргументов обычно используются в
функциях, которые должны возвращать более одного значения.
(Можно сказать, что swap возвращает два значения, новые зна-
чения ее аргументов). В качестве примера рассмотрим функцию
getint, которая осуществляет преобразование поступающих в
свободном формате данных, разделяя поток символов на целые
значения, по одному целому за одно обращение. Функция getint
должна возвращать либо найденное значение, либо признак кон-
ца файла, если входные данные полностью исчерпаны. Эти зна-
чения должны возвращаться как отдельные объекты, какое бы
значение ни использовалось для EOF, даже если это значение
вводимого целого.
    Одно из решений, основывающееся на описываемой в главе 7
функции ввода scanf, состоит в том, чтобы при выходе на ко-
нец файла getint возвращала EOF в качестве значения функции;
любое другое возвращенное значение говорит о нахождении нор-
мального целого. Численное же значение найденного целого
возвращается через аргумент, который должен быть указателем
целого. Эта организация разделяет статус конца файла и чис-
ленные значения.
    Следующий цикл заполняет массив целыми с помощью обраще-
ний к функции getint:

int n, v, array[SIZE];

for (n = 0; n &lt; SIZE &amp;&amp; getint(&v) != EOF; n++)
   array[n] = v;

В результате каждого обращения v становится равным следующе-
му целому значению, найденному во входных данных. Обратите
внимание, что в качестве аргумента getint необходимо указать
&v а не v. Использование просто v скорее всего приведет к
ошибке адресации, поскольку getint полагает, что она работа-
ет именно с указателем.
    Сама  getint  является очевидной модификацией написанной
нами ранее функции atoi:

  getint(pn)    /* get next integer from input */
  int *pn;
  {
    int c,sign;
    while ((c = getch()) == ' ' || c == '\n' || c == '\t'); /* skip white space */
    sign = 1;
    if (c == '+' || c == '-') { /* record sign */
       sign = (c == '+') ? 1 : -1;
       c = getch();
    }
    for (*pn = 0; c >= '0' &amp;&amp; c &lt;= '9'; c = getch())
       *pn = 10 * *pn + c - '0';
    *pn *= sign;
    if (c != EOF)
       ungetch(c);
    return(c);
  }

Выражение *pn используется всюду в getint как обычная пере-
менная типа int. Мы также использовали функции getch и
ungetch (описанные в главе 4) , так что один лишний символ,
кототрый приходится считывать, может быть помещен обратно во
ввод.

Упражнение 5-1
    Напишите функцию getfloat, аналог  getint  для  чисел  с
плавающей точкой. Какой тип должна возвращать getfloat в ка-
честве значения функции?
</pre>
	<script  language=JavaScript  src="../footer.js"></script>
	</body>
	
</html>
