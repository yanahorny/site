<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>

	<head>
		<meta http-equiv="content-type" content="text/html;charset=windows-1251">
		<meta name="Description" content="K&R, 1st ed., 1978. Russian translation by <unknown>; chm-compiling by Sim&C, Belarus`2006">
   		<title>7.2 Стандартный ввод и вывод - функции getchar и putchar</title>
		<link href="../style.css" rel="stylesheet" type="text/css" media="all">
	</head>

	<body>
	<script  language=JavaScript  src="../header.js"></script>
	<pre>    Самый простой механизм ввода заключается в чтении по од-
ному символу за раз из &quot;стандартного ввода&quot;, обычно с терми-
нала пользователя, с помощью функции getchar. Функция
getchar() при каждом к ней обращении возвращает следующий
вводимый символ. В большинстве сред, которые поддерживают
язык C, терминал может быть заменен некоторым файлом с по-
мощью обозначения &lt; : если некоторая программа prog исполь-
зует функцию getchar то командная строка

prog&lt;infile

приведет к тому, что prog будет читать из файла infile, а не
с терминала. Переключение ввода делается таким образом, что
сама программа prog не замечает изменения; в частности стро-
ка&quot;&lt;infile&quot; не включается в командную строку аргументов в
argv. Переключение ввода оказывается незаметным и в том слу-
чае, когда вывод поступает из другой программы посредством
поточного (pipe) механизма; командная строка

otherprog | prog

прогоняет две программы, otherprog и prog, и организует так,
что стандартным вводом для prog служит стандартный вывод
otherprog.
    Функция getchar возвращает значение EOF, когда она попа-
дает на конец файла, какой бы ввод она при этом не считыва-
ла. Стандартная библиотека полагает символическую константу
EOF равной -1 (посредством #define в файле stdio.h), но про-
верки следует писать в терминах EOF, а не -1, чтобы избежать
зависимости от конкретного значения.
    Вывод можно осуществлять с помощью функции putchar(c),
помещающей символ 'с' в &quot;стандартный вывод&quot;, который по умол-
чанию является терминалом. Вывод можно направить в некоторый
файл с помощью обозначения &gt; : если prog использует putchar,
то командная строка

prog&gt;outfile

приведет к записи стандартного вывода в файл outfile, а не
на терминал. На системе UNIX можно также использовать поточ-
ный механизм. Строка

prog | anotherprog

помещает стандартный вывод prog в стандартный ввод
anotherprog. И опять prog не будет осведомлена об изменении
направления.
    Вывод, осуществляемый функцией printf, также поступает в
стандартный вывод, и обращения к putchar и printf могут пе-
ремежаться.
    Поразительное количество программ читает только из одно-
го входного потока и пишет только в один выходной поток; для
таких программ ввод и вывод с помощью функций getchar,
putchar и printf может оказаться вполне адекватным и для на-
чала определенно достаточным. Это особенно справедливо тог-
да, когда имеется возможность указания файлов для ввода и
вывода и поточный механизм для связи вывода одной программы
с вводом другой. Рассмотрим, например, программу lower, ко-
торая преобразует прописные буквы из своего ввода в строч-
ные:

#include &lt;stdio.h&gt;

main() /* convert input to lower case */
{
  int c;
  while ((c = getchar()) != EOF)
    putchar(isupper(c) ? tolower(c) : c);
}

&quot;Функции&quot; isupper и tolower на самом деле являются макроса-
ми, определенными в stdio.h . Макрос isupper проверяет, яв-
ляется ли его аргумент буквой из верхнего регистра, и возв-
ращает ненулевое значение, если это так, и нуль в противном
случае. Макрос tolower преобразует букву из верхнего регист-
ра в ту же букву нижнего регистра. Независимо от того, как
эти функции реализованы на конкретной машине, их внешнее по-
ведение совершенно одинаково, так что использующие их прог-
раммы избавлены от знания символьного набора.
    Если требуется преобразовать несколько файлов, то можно
собрать эти файлы с помощью программы, подобной утилите cat
системы UNIX,

cat file1 file2 ... | lower&gt;output

и избежать тем самым вопроса о том, как обратиться к этим
файлам из программы. (Программа cat приводится позже в этой
главе).
    Кроме того отметим, что в стандартной библиотеке вво-
да/вывода &quot;функции&quot; getchar и putchar на самом деле могут
быть макросами. Это позволяет избежать накладных расходов на
обращение к функции для обработки каждого символа. В главе 8
мы продемонстрируем, как это делается.
</pre>
	<script  language=JavaScript  src="../footer.js"></script>
	</body>
	
</html>
